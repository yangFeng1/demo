<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Document</title>
</head>
<body>
  <input type="checkbox" class="par"><br>
  <input type="checkbox" class="son"><br>
  <input type="checkbox" class="son"><br>
  <input type="checkbox" class="son"><br>
  <input type="checkbox" class="son"><br>
  <input type="checkbox" class="son"><br>
  <button class="btn">重新加载</button>
</body>
</html>
<script src="https://cdn.bootcss.com/jquery/3.2.1/jquery.min.js"></script>
<script>
  $('.btn').on('click',function(){
    $('body').html('<input type="checkbox" class="par"><br><input type="checkbox" class="son"><br><input type="checkbox" class="son"><br><input type="checkbox" class="son"><br><input type="checkbox" class="son"><br>')
  })
  checkbox($('.particulars'),'.allIcon','.icon')

  function checkbox(par,sonOne,sonTow){//第一个参数为checkBox的父元素（不会更改的），第二个全选按钮，第三个为普通按钮
    par.on('click',sonOne,function(){//判断全选按钮是否为选中状态
      if($(this).hasClass("clickIcon")){
        $(sonTow).each(function(i,v){//为选中状态让每一个都为选中状态
          $(v).attr('class','icon clickIcon')
        })
      }else{
        $(sonTow).each(function(i,){//和上面的相反
          $(v).attr('class','icon')
        })
      }
    })
    par.on('click',sonTow,function(v,i){
      var falg = true  //判断当前全选按钮是否需要选中
      if($(this).hasClass('clickIcon')){//当有一个子按钮被选中时判断其他子按钮是否全部被选中（用来判断是否需要选中全选按钮）
         $(sonTow).each(function(v,i){
          if(!($(i).hasClass('clickIcon'))){
            return falg = false
          }
        })
         if(falg){
            $(sonOne).attr('class','allIcon clickIcon')
          }
      }else{//取消一个子按钮的选中状态是取消全选按钮的选中状态
        $(sonOne).removeClass('clickIcon')
      }
    })
  }
</script>
